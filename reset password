<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="resetpassword.aspx.cs" Inherits="WebApplication1.resetpassword" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Reset Password</title>
    <style>
        body {
            background-color: #305830;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        
        #form-container {
            width: 300px;
            margin: 100px auto;
            padding: 20px;
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.5);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }
        
        h2 {
            text-align: center;
        }
        
        input[type=text] {
            width: calc(100% - 20px);
            padding: 8px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            background-color: #fff;
            color: #333;
        }
        
        input[type=button] {
            width: calc(100% - 20px);
            padding: 10px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }
        
        input[type=button]:hover {
            background-color: #45a049;
        }
        
        .otp-panel {
            display: none;
        }
    </style>
</head>
<body>
    <form id="form1" runat="server">
        <div id="form-container">
            <h2>Reset Password</h2>
            <asp:Label ID="lblMessage" runat="server" Text=""></asp:Label>
            <asp:TextBox ID="txtEmail" runat="server" placeholder="Enter your email"></asp:TextBox>
            <asp:Button ID="btnSendOTP" runat="server" Text="Send OTP" OnClick="btnSendOTP_Click" />
            <div id="pnlOTP" class="otp-panel" runat="server">
                <asp:TextBox ID="txtOTP" runat="server" placeholder="Enter OTP"></asp:TextBox>
                <asp:Button ID="btnVerifyOTP" runat="server" Text="Verify OTP" OnClick="btnVerifyOTP_Click" />
            </div>
        </div>
    </form>
</body>
</html>






using System;
using System.Net.Mail;

namespace WebApplication1
{
    public partial class resetpassword : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void btnSendOTP_Click(object sender, EventArgs e)
        {
            // Generate a random OTP (You may have your own method for generating OTP)
            Random random = new Random();
            string otp = random.Next(100000, 999999).ToString();

            // Get the email address entered by the user
            string userEmail = txtEmail.Text;

            // Send the OTP to the user's email address
            SendOTP(userEmail, otp);

            // You can optionally store the OTP in a session or database for verification later
            Session["OTP"] = otp;

            // Show the OTP input panel
            pnlOTP.Visible = true;
        }

        protected void btnVerifyOTP_Click(object sender, EventArgs e)
        {
            // Get the OTP entered by the user
            string enteredOTP = txtOTP.Text;

            // Get the OTP stored in session or database
            string storedOTP = Session["OTP"] as string;

            if (storedOTP != null) // Check if storedOTP is not null
            {
                // Verify the entered OTP with the stored OTP
                if (enteredOTP == storedOTP)
                {
                    lblMessage.Text = "OTP verified successfully!";
                    // Redirect to password reset page or perform further actions
                }
                else
                {
                    lblMessage.Text = "Invalid OTP. Please try again.";
                }
            }
            else
            {
                lblMessage.Text = "Session expired. Please request a new OTP.";
            }
        }

        // Method to send OTP via email
        private void SendOTP(string userEmail, string otp)
        {
            // Configure the SMTP client
            SmtpClient smtpClient = new SmtpClient("smtp.gmail.com");
            smtpClient.Port = 587; // You may need to change this port based on your email provider
            smtpClient.EnableSsl = true; // Enable SSL if required
            smtpClient.Credentials = new System.Net.NetworkCredential("azjohnemmanuel@gmail.com", "ekdgjdbbhhkfhkqi");

            // Prepare the email message
            MailMessage mailMessage = new MailMessage();
            mailMessage.From = new MailAddress("azjohnemmanuel@gmail.com");
            mailMessage.To.Add(userEmail);
            mailMessage.Subject = "Reset Password OTP";
            mailMessage.Body = "Your OTP is: " + otp;

            // Send the email
            smtpClient.Send(mailMessage);
        }
    }
}
